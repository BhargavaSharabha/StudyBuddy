<!-- Toast Messages Include -->
{% if messages %}
<!-- Convert Django messages to JSON for JavaScript consumption -->
<script id="django-messages" type="application/json">
[
  {% for message in messages %}
  {
    "message": "{{ message|escapejs }}",
    "tags": "{{ message.tags|escapejs }}"
  }{% if not forloop.last %},{% endif %}
  {% endfor %}
]
</script>

<style>
/* Custom toast styling */
.toast {
  border-radius: 4px !important;
  font-family: 'Poppins', sans-serif !important;
  font-weight: 500 !important;
  box-shadow: 0 4px 10px rgba(0,0,0,0.3) !important;
}

.toast.success {
  background-color: #4caf50 !important;
  color: white !important;
}

.toast.error {
  background-color: #f44336 !important;
  color: white !important;
}

.toast.warning {
  background-color: #ff9800 !important;
  color: white !important;
}

.toast.info {
  background-color: #2196f3 !important;
  color: white !important;
}

.toast-action {
  color: white !important;
  font-weight: 600 !important;
  margin-left: 10px !important;
}

.toast-action:hover {
  background-color: rgba(255,255,255,0.1) !important;
}

.toast i {
  margin-right: 8px !important;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Get Django messages from JSON script tag
  const messagesElement = document.getElementById('django-messages');
  if (messagesElement) {
    const messages = JSON.parse(messagesElement.textContent);
    
    // Function to get toast class based on message tags
    function getToastClass(tags) {
      if (tags.includes('success')) return 'success';
      if (tags.includes('error')) return 'error';
      if (tags.includes('warning')) return 'warning';
      if (tags.includes('info')) return 'info';
      return 'info'; // default
    }
    
    // Function to get display length based on message type
    function getDisplayLength(tags) {
      if (tags.includes('error')) return 6000; // 6 seconds for errors
      if (tags.includes('warning')) return 4000; // 4 seconds for warnings
      return 3000; // 3 seconds for success and info
    }
    
    // Function to get icon based on message type
    function getIcon(tags) {
      if (tags.includes('success')) return 'check_circle';
      if (tags.includes('error')) return 'error';
      if (tags.includes('warning')) return 'warning';
      if (tags.includes('info')) return 'info';
      return 'notifications';
    }
    
    // Display each message as a toast
    messages.forEach(function(message) {
      const icon = getIcon(message.tags);
      const toastClass = getToastClass(message.tags);
      const displayLength = getDisplayLength(message.tags);
      
      // Create toast HTML with icon
      const toastHTML = `<i class="material-icons">${icon}</i><span>${message.message}</span>`;
      
      // Show toast
      M.toast({
        html: toastHTML,
        classes: toastClass,
        displayLength: displayLength,
        inDuration: 300,
        outDuration: 375,
        activationPercent: 0.8
      });
    });
  }
});
</script>
{% endif %} 